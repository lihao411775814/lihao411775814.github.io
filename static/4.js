webpackJsonp([4],{100:function(t,a,e){t.exports=e.p+"readCard.gif?5952c50"},464:function(t,a,e){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(a,"__esModule",{value:!0});var o=e(3),r=s(o),n=e(19),i=s(n),d=e(248),c=s(d),u=e(2),l=s(u);a.default={title:"读卡",name:"cardMain",data:function(){return{hasCardCount:0,readCardTime:null,isAndroid:!1,cardInfo:{}}},methods:{back:function(t){this.$back(t)},card:function(){var t=this;this.readCardTime=window.setInterval(function(){t.hasCardCount++,t.hasCard()},1e3)},hasCard:function(){var t=c.default.hasCard(this.hasCardCount);console.log("第",this.hasCardCount,"遍判卡，结果是",t),(t||5===this.hasCardCount)&&(window.clearInterval(this.readCardTime),t?this.readCard():this.$showMessage("未检测到卡,请检查卡槽是否有卡或异物！"))},readCard:function(){function t(){return a.apply(this,arguments)}var a=(0,i.default)(r.default.mark(function t(){var a;return r.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return console.log("判卡成功"),t.next=3,c.default.read();case 3:a=t.sent,200===a.code?(this.cardInfo=a.msg,this.getUserInfo()):500===a.code?(this.$showMessage("请检查卡是否插好，异常信息",a.msg),this.back()):(this.$showMessage("调用读卡器失败,请联系管理员！"),this.back());case 5:case"end":return t.stop()}},t,this)}));return t}(),getUserInfo:function(){var t=this,a="f_card_id = '"+this.cardInfo.CardID+"' and f_alias like '%"+this.cardInfo.Factory+"%'";this.$PosUtil.posParam.filiale.hasFiliale&&(a+=this.$PosUtil.posParam.filiale.condition),this.$resetpost(l.default.ProxyUrl+"/rs/logic/"+this.$PosUtil.posParam.revenue+"getUserfile",{data:{condition:a}},{resolveMsg:null,rejectMsg:null}).then(function(a){"正常"!==a.data.userInfo.f_table_state?t.back('该表状态为"'+a.data.userInfo.f_table_state+'"不能购气,请联系工作人员'):(console.log("跳转页面"),t.$goto("user-info",{userInfo:a.data.userInfo,stairPrices:a.data.sells,cardInfo:t.cardInfo},"self",t.back()))}).catch(function(a){404===a.status?t.back("连接后台服务失败,请检查网络连接或联系工作人员！"):500===a.status?t.back("请确认是否为正确的燃气卡！"+a.data):t.back("查询不到该档案,请联系工作人员！")})}},ready:function(){this.card()}}},764:function(t,a,e){a=t.exports=e(74)(),a.push([t.id,"","",{version:3,sources:[],names:[],mappings:"",file:"CardMain.vue",sourceRoot:"webpack://"}])},795:function(t,a,e){var s=e(764);"string"==typeof s&&(s=[[t.id,s,""]]);e(134)(s,{});s.locals&&(t.exports=s.locals)},913:function(t,a,e){t.exports=' <div> <div class=mhead> <ul> <li> <text>自助缴费机</text> </li> </ul> </div> <div class=body style="background: #f0f0f0;padding: 20%;margin: 0 auto"> <div> <h5>请插好燃气卡,等待自动读卡</h5> <img src='+e(100)+"> </div> </div> <div class=foot @click=\"back('tomain')\"> <text>返回</text> </div> </div> "},1037:function(t,a,e){var s,o,r={};e(795),s=e(464),o=e(913),t.exports=s||{},t.exports.__esModule&&(t.exports=t.exports.default);var n="function"==typeof t.exports?t.exports.options||(t.exports.options={}):t.exports;o&&(n.template=o),n.computed||(n.computed={}),Object.keys(r).forEach(function(t){var a=r[t];n.computed[t]=function(){return a}})}});
//# sourceMappingURL=4.js.map