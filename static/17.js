webpackJsonp([17],{472:function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(t,"__esModule",{value:!0});var r=a(41),i=s(r),n=a(3),c=s(n),o=a(2),f=s(o),u=a(7),l=s(u),d=c.default.mark(function e(t,a){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.$resetpost(f.default.ProxyUrl+"/rs/logic/"+t.$PosUtil.posParam.revenue+"commonCal",{data:{model:t.stairPrice,isGasValue:0,value:a}},{resolveMsg:null,rejectMsg:null}));case 1:case"end":return e.stop()}},e,this)}),p=c.default.mark(function e(t,a){return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.$resetpost(f.default.ProxyUrl+"/rs/logic/"+t.$PosUtil.posParam.revenue+"commonCal",{data:{model:t.stairPrice,isGasValue:1,value:a}},{resolveMsg:null,rejectMsg:null}));case 1:case"end":return e.stop()}},e,this)}),_=c.default.mark(function e(t){var a;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"是"===t.userInfo.f_isdecimal?t.stairPrice.f_pregas=Number((t.stairPrice.f_pregas-0).toFixed(2)):t.stairPrice.f_pregas=Number((t.stairPrice.f_pregas-0).toFixed(0)),e.prev=1,e.next=4,(0,l.default)(d(t,t.stairPrice.f_pregas));case 4:a=e.sent,console.log(a),a&&(a.data.f_stair1fee=Number(a.data.f_stair1fee),a.data.f_stair2fee=Number(a.data.f_stair2fee),a.data.f_stair3fee=Number(a.data.f_stair3fee),t.stair=a.data,t.stairPrice.f_preamount=Number(Number(a.data.chargenum).toFixed(2)),(0,i.default)(t.stairPrice,t.stairPrice,a.data),t.stairPrice.f_temp_amount=Number(t.stairPrice.f_preamount-0-(t.stairPrice.f_balance-0)),t.stairPrice.f_collection=Number(t.stairPrice.f_temp_amount)),e.next=15;break;case 9:e.prev=9,e.t0=e.catch(1),console.log(e.t0.stack),t.clearNum(),404===e.t0.status?t.$showMessage("连接后台服务器失败，请重新划价"):501===e.t0.status?t.$showMessage(e.t0.data+"，请重新划价"):t.$showMessage("划价错误，请重新划价"),t.iserro=!0;case 15:case"end":return e.stop()}},e,this,[[1,9]])}),h=c.default.mark(function e(t){var a,s,r,n;return c.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a=0,a=t.stairPrice.f_temp_amount?t.stairPrice.f_temp_amount:0,s=a-0+(t.userInfo.f_balance-0),e.next=6,(0,l.default)(p(t,s));case 6:if(r=e.sent,n=null,!f.default.PosUtil.posParam.gasAfterFee){e.next=33;break}if(!r.data.gas){e.next=31;break}if("是"!==t.userInfo.f_isdecimal){e.next=22;break}return t.stairPrice.f_pregas=(r.data.gas-0).toFixed(2),e.next=14,(0,l.default)(d(t,r.data.gas));case 14:n=e.sent,n.data.f_stair1fee=Number(n.data.f_stair1fee),n.data.f_stair2fee=Number(n.data.f_stair2fee),n.data.f_stair3fee=Number(n.data.f_stair3fee),n.data.chargenum=Number(n.data.chargenum),t.stairPrice.f_preamount=Number((n.data.chargenum-0).toFixed(2)),e.next=31;break;case 22:return t.stairPrice.f_pregas=parseInt(r.data.gas-0),e.next=25,(0,l.default)(d(t,t.stairPrice.f_pregas));case 25:n=e.sent,n.data.f_stair1fee=Number(n.data.f_stair1fee),n.data.f_stair2fee=Number(n.data.f_stair2fee),n.data.f_stair3fee=Number(n.data.f_stair3fee),n.data.chargenum=Number(n.data.chargenum),t.stairPrice.f_preamount=Number(n.data.chargenum.toFixed(2));case 31:e.next=36;break;case 33:n=r,t.stairPrice.f_pregas=(r.data.gas-0).toFixed(2),t.stairPrice.f_preamount=Number(n.data.chargenum.toFixed(2));case 36:t.stair=n.data,(0,i.default)(t.stairPrice,t.stairPrice,n.data),t.stairPrice.f_collection=Number(t.stairPrice.f_temp_amount),t.iserro=!1,e.next=48;break;case 42:e.prev=42,e.t0=e.catch(0),t.clearNum(),console.log(),404===e.t0.status?t.$showMessage("连接后台服务器失败，请重新划价或联系管理人员"):501===e.t0.status?t.$showMessage(e.t0.data+"，请重新划价或联系管理人员"):t.$showMessage("划价错误，请重新划价或联系管理人员"),console.log(e.t0);case 48:case"end":return e.stop()}},e,this,[[0,42]])});t.default={title:"划价",data:function(){return{isguding:!1,hideHead:!1,sInfos:{gas:[{para:"40方",isActive:!1},{para:"60方",isActive:!1},{para:"80方",isActive:!1},{para:"100方",isActive:!1},{para:"150方",isActive:!1},{para:"200方",isActive:!1},{para:"其他",isActive:!1}],money:[{para:"50元",isActive:!1},{para:"100元",isActive:!1},{para:"150元",isActive:!1},{para:"200元",isActive:!1},{para:"250元",isActive:!1},{para:"300元",isActive:!1}]},stairPrice:{f_preamount:0,f_pregas:0,f_price_id:0,f_balance:0,f_curbalance:0,f_temp_amount:0,f_collection:0,f_delaypay:0,hand_ids:[]},canbuy:!1,rows:[],type:"",stair:{f_stair1fee:0,f_stair2fee:0,f_stair3fee:0}}},props:["userInfo","cardInfo","stairPrices"],methods:{back:function(e){"tosell"!==e&&this.$back(e)},verifyCard:function(){"物联网表"!==this.userInfo.f_meter_type&&this.$goto("choose-pay-way",{userInfo:this.userInfo,cardInfo:this.cardInfo,stairPrice:this.stairPrice},"self",this.callBack);var e=this.$AndroidPlugin.read();this.$closeAlert(),this.gotoComponents(e)},gotoComponents:function(e){200===e.code&&e.msg.CardID===this.cardInfo.CardID?(this.stairPrice.f_curbalance=Number(this.curbalance).toFixed(2),this.$goto("choose-pay-way",{userInfo:this.userInfo,cardInfo:this.cardInfo,stairPrice:this.stairPrice},"self",this.callBack)):this.$back("卡号不一致，请重新读卡购气！")},maffrim:function(){this.verifyCard()},gasfeecalculate:function(){var e=feecalculateGen(this);return(0,l.default)(e)},clearNum:function(){this.stairPrice.f_temp_amount="按金额"===this.userInfo.f_collection_type?null:0,this.stairPrice.f_pregas="按金额"===this.userInfo.f_collection_type?0:null,this.stairPrice.f_preamount=0,this.stairPrice.f_collection=0,this.stair={}},pregas:function(){if("按金额"!==this.userInfo.f_collection_type&&this.stairPrice.f_pregas&&this.stairPrice.f_pregas>0){if(this.stairPrice.f_pregas>this.userInfo.f_remain_gas)return this.$showMessage(this.userInfo.f_cycle_start+"至"+this.userInfo.f_cycle_end+"限购气量为"+this.userInfo.limit_gas+"方，剩余可购气量为"+this.userInfo.f_remain_gas+"方，请重新选择购气量且不要大于"+this.userInfo.f_remain_gas+"方"),void this.clearNum();(0,l.default)(_(this))}},preamount:function(){"按金额"===this.userInfo.f_collection_type&&(this.stairPrice.f_temp_amount&&this.stairPrice.f_temp_amount>0?(this.stairPrice.f_temp_amount=(this.stairPrice.f_temp_amount-0).toFixed(2),(0,l.default)(h(this))):this.clearNum())},fastBuy:function(){var e=event.currentTarget;console.log("nodes",e),console.log("this.rows",this.rows);for(var t=0;t<this.rows.length;t++)this.rows[t].isActive=!1,this.rows[t].para===e.innerText&&(this.rows[t].isActive=!0);"其他"!==e.innerText?(this.isReadOnly=!0,"按金额"===this.userInfo.f_collection_type?(this.stairPrice.f_temp_amount=parseInt(e.innerText.substr(0,e.innerText.length-1)),this.preamount()):(this.stairPrice.f_pregas=parseInt(e.innerText.substr(0,e.innerText.length-1)),this.pregas())):(this.isReadOnly=!1,this.clearNum())},callBack:function(e){"getbillerro"===e?this.$showMessage("下单失败，请重新确认订单！"):"timeout"===e?this.$showMessage("未查询到支付记录请重新确认订单！（已支付用户请等待自动退款再重新购气，如未退款请联系工作人员）"):"checkbillerro"===e?this.$showMessage("查询支付情况失败，请重新下单支付!（如已支付请到营业厅办理）"):this.back(e)}},computed:{curbalance:function(){return""!==this.stairPrice.f_preamount&&""!==this.stairPrice.f_temp_amount?"按金额"===this.userInfo.f_collection_type?(this.stairPrice.f_collection-0+(this.stairPrice.f_balance-0)-(this.stairPrice.f_preamount-0)).toFixed(2):(this.stairPrice.f_collection-0-(this.stairPrice.f_temp_amount-0)).toFixed(2):0}},watch:{"stairPrice.f_temp_amount":function(e){this.stairPrice.f_temp_amount&&this.stairPrice.f_preamount>0?this.canbuy=!0:this.canbuy=!1},"stairPrice.f_preamount":function(e){e>0&&this.stairPrice.f_temp_amount?this.canbuy=!0:this.canbuy=!1}},ready:function(){console.log("进入购气划价界面"),console.log("userinfo和cardinfo",this.userInfo,this.cardInfo),this.stairPrice.f_price_id=this.userInfo.f_price_id,this.stairPrice.f_user_id=this.userInfo.f_user_id,this.stairPrice.f_meter_type=this.userInfo.f_meter_type,this.stairPrice.f_balance=this.userInfo.f_balance,console.log("this.userInfo.f_collection_type",this.userInfo.f_collection_type),"按金额"===this.userInfo.f_collection_type?(this.type="金额",this.rows=this.sInfos.money):(this.type="气量",this.rows=this.sInfos.gas),"阶梯气价"===this.userInfo.f_price_type?this.isguding=!1:"固定气价"===this.userInfo.f_price_type&&(this.isguding=!0)}}},921:function(e,t){e.exports=' <div> <div class=cardsellgas> <div class=mhead v-if=!hideHead> <ul> <li> <text>购气写卡</text> </li> </ul> </div> <div class=body> <div class=selectview> <h5>请选择购气{{type}} </h5> <ul class=selectbuy1 v-for="row in rows"> <li><a href=# v-bind:class="{ getfocus: row.isActive }" @click=fastBuy()><span>{{row.para}}</span></a></li> </ul> </div> <table class=tabprice> <tr> <td class=lab>预购金额：</td> <td><input type=number v-model=stairPrice.f_preamount readonly=readonly /></td> <td class=lab align=right>预购气量：</td> <td><input type=number v-model=stairPrice.f_pregas @blur=pregas() placeholder=请输入气量 :readonly="userInfo.f_collection_type === \'按金额\'||isReadOnly"/></td> <td class=lab align=right>本次缴费：</td> <td><input type=number v-model=stairPrice.f_temp_amount @blur=preamount() placeholder=请输入金额 :readonly="userInfo.f_collection_type !== \'按金额\'||isReadOnly"/></td> </tr> </table> <div class=stairview> <guding-price v-if=isguding :stair=stair> </guding-price> <jieti-price v-if=!isguding :stair=stair> </jieti-price> </div> <div class=buybtn style="margin-top: -10%"> <button type=button class="btn btn-success" @click=maffrim() :disabled=!canbuy> 确认订单 </button> </div> </div> </div> <div class=foot style="margin-top: -18%" @click="back(\'tomain\')"> <text>返回</text> </div> </div> '},1045:function(e,t,a){var s,r,i={};s=a(472),r=a(921),e.exports=s||{},e.exports.__esModule&&(e.exports=e.exports.default);var n="function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports;r&&(n.template=r),n.computed||(n.computed={}),Object.keys(i).forEach(function(e){var t=i[e];n.computed[e]=function(){return t}})}});
//# sourceMappingURL=17.js.map